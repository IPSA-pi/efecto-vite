import {
  require_p5_min
} from "./chunk-TYVIZ3OS.js";
import {
  require_react
} from "./chunk-YNCU75EO.js";
import {
  __toESM
} from "./chunk-WNKWOKNR.js";

// node_modules/react-p5-wrapper/dist/react-p5-wrapper/index.browser.js
var import_react = __toESM(require_react());

// node_modules/microdiff/dist/index.js
var richTypes = { Date: true, RegExp: true, String: true, Number: true };
function diff(obj, newObj, options = { cyclesFix: true }, _stack = []) {
  var _a, _b;
  let diffs = [];
  const isObjArray = Array.isArray(obj);
  for (const key in obj) {
    const objKey = obj[key];
    const path = isObjArray ? +key : key;
    if (!(key in newObj)) {
      diffs.push({
        type: "REMOVE",
        path: [path],
        oldValue: obj[key]
      });
      continue;
    }
    const newObjKey = newObj[key];
    const areObjects = typeof objKey === "object" && typeof newObjKey === "object";
    if (objKey && newObjKey && areObjects && !richTypes[(_b = (_a = Object.getPrototypeOf(objKey)) == null ? void 0 : _a.constructor) == null ? void 0 : _b.name] && (!options.cyclesFix || !_stack.includes(objKey))) {
      const nestedDiffs = diff(
        objKey,
        newObjKey,
        options,
        options.cyclesFix ? _stack.concat([objKey]) : []
      );
      diffs.push.apply(
        diffs,
        nestedDiffs.map((difference) => {
          difference.path.unshift(path);
          return difference;
        })
      );
    } else if (objKey !== newObjKey && !(areObjects && (isNaN(objKey) ? objKey + "" === newObjKey + "" : +objKey === +newObjKey))) {
      diffs.push({
        path: [path],
        type: "CHANGE",
        value: newObjKey,
        oldValue: objKey
      });
    }
  }
  const isNewObjArray = Array.isArray(newObj);
  for (const key in newObj) {
    if (!(key in obj)) {
      diffs.push({
        type: "CREATE",
        path: [isNewObjArray ? +key : key],
        value: newObj[key]
      });
    }
  }
  return diffs;
}

// node_modules/react-p5-wrapper/dist/react-p5-wrapper/index.browser.js
var import_p5 = __toESM(require_p5_min());
var l = function() {
  return l = Object.assign || function(r2) {
    for (var e2, t2 = 1, n2 = arguments.length; t2 < n2; t2++)
      for (var o2 in e2 = arguments[t2])
        Object.prototype.hasOwnProperty.call(e2, o2) && (r2[o2] = e2[o2]);
    return r2;
  }, l.apply(this, arguments);
};
var i = "react-p5-wrapper";
function a(r2) {
  var e2;
  null === (e2 = r2.current) || void 0 === e2 || e2.remove(), r2.current = null;
}
function p(o2) {
  var c = o2.sketch, l2 = o2.children, p2 = function(r2, e2) {
    var t2 = {};
    for (var n2 in r2)
      Object.prototype.hasOwnProperty.call(r2, n2) && e2.indexOf(n2) < 0 && (t2[n2] = r2[n2]);
    if (null != r2 && "function" == typeof Object.getOwnPropertySymbols) {
      var o3 = 0;
      for (n2 = Object.getOwnPropertySymbols(r2); o3 < n2.length; o3++)
        e2.indexOf(n2[o3]) < 0 && Object.prototype.propertyIsEnumerable.call(r2, n2[o3]) && (t2[n2[o3]] = r2[n2[o3]]);
    }
    return t2;
  }(o2, ["sketch", "children"]), f2 = (0, import_react.createRef)(), v = (0, import_react.useRef)(null);
  return (0, import_react.useEffect)(function() {
    null !== f2.current && (a(v), v.current = function(r2, e2) {
      return new import_p5.default(r2, e2);
    }(c, f2.current));
  }, [c]), (0, import_react.useEffect)(function() {
    var r2, e2;
    null === (e2 = null === (r2 = v.current) || void 0 === r2 ? void 0 : r2.updateWithProps) || void 0 === e2 || e2.call(r2, p2);
  }, [p2, f2]), (0, import_react.useEffect)(function() {
    return function() {
      return a(v);
    };
  }, []), import_react.default.createElement("div", { ref: f2, className: i }, l2);
}
var f = (0, import_react.memo)(function(e2) {
  return void 0 === e2.sketch ? (console.error("[ReactP5Wrapper] The `sketch` prop is required."), null) : import_react.default.createElement(p, l({}, e2));
}, function(r2, e2) {
  return 0 === diff(r2, e2).length;
});
export {
  i as P5WrapperClassName,
  f as ReactP5Wrapper
};
//# sourceMappingURL=react-p5-wrapper.js.map
